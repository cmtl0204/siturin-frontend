<p-fluid>
    <div class="card flex flex-col gap-4 w-full">
        <p-message severity="info">
            <div>
                <p class="text-lg font-semibold ">Importante</p>

                <p>
                    Es obligatorio declarar al menos una de las siguientes Actividades Turísticas:
                </p>
            </div>
        </p-message>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-3">
            <h2>Actividades Turísticas Declaradas</h2>

            <form [formGroup]="form" class="card flex justify-center">
                <p-multiselect
                    [options]="activities"
                    formControlName="activities"
                    optionLabel="name"
                    appendTo="body"
                    placeholder="Seleccione las Actividades Disponibles">
                </p-multiselect>
            </form>
        </div>

        @if (activitiesField.value) {
            <p-panel header="Formulario por Actividad">
                <p-tabs [(value)]="tabSelected">
                    <p-tablist>
                        @for (tab of activitiesField.value; track tab; let i = $index) {
                            <p-tab [value]="i">
                                {{ tab.name }}
                            </p-tab>
                        }
                    </p-tablist>

                    @for (tab of activitiesField.value; track tab; let i = $index) {
                        <p-tabpanel [value]="i">
                            @switch (tab.code) {
                                @case (CatalogueCtcActivitiesCodeEnum.food_drink) {
                                    <app-food-drink (dataOut)="saveFoodDrinkForm($event)" [modelId]="activitiesField.value[i].id"  />
                                }
                                @case (CatalogueCtcActivitiesCodeEnum.accommodation) {
                                    <app-accommodation (dataOut)="saveAccommodationForm($event)" [modelId]="activitiesField.value[i].id"/>
                                }
                                @case (CatalogueCtcActivitiesCodeEnum.community_operation) {
                                    <app-community-operation
                                        (dataOut)="saveCommunityOperationForm($event)" [modelId]="activitiesField.value[i].id"/>
                                }
                                @case (CatalogueCtcActivitiesCodeEnum.transport) {
                                    <app-transport
                                        (dataOut)="saveTouristTransportCompanyForm($event)" [modelId]="activitiesField.value[i].id"/>
                                }
                            }
                        </p-tabpanel>
                    }
                </p-tabs>
            </p-panel>
        }
    </div>
</p-fluid>
